<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="balgil.com.trip.route">
	<select id="ROUTE_SELECT_ALL" resultType="balgil.com.trip.route.model.RouteVO">
		select * from ROUTE
		where seller_id = #{seller_id} order by id desc
	</select>
	
	<!-- 
	설명은 밑 링크 참조
	https://github.com/kimsha1228/FinalProject/wiki/MyBatis-%EC%97%90%EC%84%9C-foreach-%ED%99%9C%EC%9A%A9 -->
	<insert id="ROUTE_INSERT" parameterType="balgil.com.trip.route.model.RouteVO">
	  INSERT INTO "ROUTE" ("ID", "ROUTE_NAME", "CONTENT", "IMG", "SUMMARY", "SELLER_ID", "DEST_ID"
		  <foreach item="rt" index="index" open=", " separator=", " close="" collection="rts">
		    "RT${index + 1}"
		  </foreach>
	  )
	  VALUES (SEQ_ROUTE.nextval, #{route_name}, #{content}, #{img}, #{summary}, #{seller_id}, #{dest_id}
		  <foreach item="rt" index="index" open=", " separator=", " close="" collection="rts">
		    #{rt}
		  </foreach>
	  )
	</insert>
	
	
	<update id="ROUTE_UPDATE" parameterType="balgil.com.trip.route.model.RouteVO">
		update ROUTE set ACT_NAME=#{act_name} , CONTENT=#{content} , 
				TAG=#{tag} , "ADD"=#{add}, DEST_ID=#{dest_id},
				PRICE=#{price}, ACT_DATE=SYSDATE
		where ID = #{id}
	</update>
	
	<update id="ROUTE_VCOUNTUP" parameterType="balgil.com.trip.route.model.RouteVO">
		update ROUTE set vcount=vcount+1
		where ID = #{id}
	</update>
	
	<delete id="ROUTE_DELETE">
		delete from ROUTE where id = #{id}
	</delete>
</mapper>